import csv
import time
import pymysql
import requests
from bs4 import BeautifulSoup

#
# 관련 영화 코드 번호 추출
code_num=[191613, 171539, 174830, 192608, 144906,
          151196, 186114, 169240, 192613, 196843,
          175092, 213746, 157243, 181710, 179518,
          17421, 196828, 10200, 154667, 35939,
          18988, 10016, 69105, 10102, 156464,
          10002, 17159, 29217, 18847, 106360,
          197647, 22126, 35901, 82432, 24452,
          32686, 66463, 31162, 187320, 147092,
          14450, 11678, 34324, 31796, 203288,
          37886, 161850, 181700, 134899, 12482,
          18543, 30688, 142632, 154573, 19079,
          17541, 130850, 19099, 31795, 73372,
          51172, 17441, 19303, 12270, 39636,
          16210, 10038, 17135, 182348, 76667,
          62586, 34181, 10114, 13008, 189075,
          31013, 189111, 189027, 73476, 16466,
          34227, 87566, 35187, 18782, 144318,
          25915, 52120, 75470, 10001, 29657,
          17153, 13500, 10249, 71081, 87307,
          10244, 169561, 14448, 12297, 31268,
          39584, 180220, 10746, 178434, 10012,
          65021, 184517, 18052, 28788, 31794,
          18817, 176354, 32112, 31726, 89752,
          183132, 25266, 17869, 11608, 17111,
          76309, 195975, 11104, 167787, 10670,
          16521, 183136, 70651, 51708, 10021,
          30306, 150376, 16531, 38613, 16216,
          192066, 125724, 53951, 51083, 144100,
          70773, 196051, 68555, 79762, 19074,
          70251, 182525, 54900, 58323, 18781,
          31159, 75413, 194334, 17162, 10101,
          13967, 151752, 10028, 109193, 59075,
          100654, 213733, 10936, 45774, 27578,
          10217, 148338, 12393, 199860, 41375,
          44529, 29059, 187051, 36718, 167107,
          10020, 34010, 83893, 51462, 71509,
          29953, 31170, 13172, 30897, 130013,
          35100, 52515, 185275, 17903, 63403,
          175727, 39436, 134841, 17486, 50672,
          68502, 31148, 31788, 11295, 158191,
          142305, 24542, 79435, 79749, 48602,
          12993, 10058, 10314, 10185, 10341,
          10600, 75216, 68031, 142304, 18552,
          136990, 10647, 164907, 144379, 10018,
          190395, 115298, 10046, 18610, 28677,
          32116, 36666, 190244, 151106, 16217,
          139613, 154437, 38091, 47152, 181286,
          10072, 10003, 38227, 171725, 17440,
          10047, 10061, 11003, 18542, 37486,
          134772, 154379, 58088, 57723, 187322,
          172174, 168050, 143469, 10561, 51143,
          63513, 199269, 201898, 32610, 195687,
          22082, 11002, 19469, 24194, 160135,
          10688, 138877, 19335, 10110, 75378,
          18934, 34093, 10980, 63156, 181717,
          10669, 180361, 10039, 39857, 158578,
          12324, 13957, 62329, 85825, 17796,
          145736, 17942, 66801, 173692, 10071,
          10740, 169348, 87308, 135843, 17131,
          17685, 13042, 26333, 19521, 187308,
          180372, 64128, 13234, 31110, 161242,
          143495, 62265, 19527, 67696, 16487,
          24008, 65463, 167699, 17997, 94594,
          137358, 82219, 47986, 194463, 16998,
          66724, 58437, 46985, 201073, 19031,
          16503, 32115, 88473, 100931, 17327,
          10448, 120788, 154222, 93005, 16091,
          17254, 31801, 31422, 56083, 123688,
          37888, 10004, 76016, 113132, 38444,
          33410, 180379, 10037, 37880, 189000,
          18871, 109905, 10282, 150687, 45290,
          164290, 162824, 10050, 213624, 39640,
          24830, 36565, 180687, 177374, 11502,
          19128, 14152, 18173, 184518, 53158,
          31475, 125417, 155356, 19068, 24668,
          44111, 10609, 164104, 10181, 10019,
          17970, 129802, 16172, 68695, 18865,
          69102, 14802, 24094, 10113, 39813,
          165461, 11307, 16868, 10006, 115622,
          39654, 39809, 133402, 62266, 27245,
          29102, 210807, 117787, 39440, 54973,
          70910, 184403, 36992, 14012, 38899,
          85094, 195970, 53881, 16601, 68567,
          10630, 153621, 13480, 10040, 76460,
          200896, 45264, 17092, 180169, 25906,
          122131, 192623, 60753, 17260, 19147,
          10035, 26112, 26677, 37759, 129781,
          173019, 36858, 202381, 62263, 83213,
          129764, 56414, 53034, 17524, 18827,
          30076, 39894, 36944, 39434, 165022,
          47321, 185282, 96379, 47411, 97696,
          50724, 103331, 183772, 16208, 10064,
          107992, 10828, 187351, 37398, 91101,
          74205, 46494,146469, 177335, 172006,
          179694, 33755, 178097, 146560, 43208,
          182699, 27899, 37929, 10034, 31778,
          75508, 101966, 72054, 96372, 188056,
          71760, 141675, 83883, 29756, 11141,
          10242, 31231, 62262, 155963, 154653,
          10970, 102875, 52528, 86381, 202903,
          143357, 98403, 95767, 10504, 10751,
          88669, 27219, 109778, 136876, 191920,
          10262, 168693, 115977, 52504, 149511,
          130989, 137865, 156912, 18050, 66158,
          120076, 118917, 112040, 107924, 101901,
          181912, 31906, 53441, 39810, 10005,
          18682, 21162, 26679, 44020, 174659,
          121788, 38464, 70427, 82428, 36727,
          23859, 10007, 146512, 65998, 68563,
          10238, 95260, 149049, 17626, 88793,
          19516, 100022, 73339, 38835, 144938,
          30796, 57997, 191597,144083, 24926,
          69917, 168023, 209496, 64129, 45298,
          31118, 164115, 32911, 121048, 33870,
          10532, 10877, 182387, 53945, 81890,
          77117, 168012, 36590,
          36799, 38097, 34566, 61848, 183866, 17764, 37439, 117061, 115534, 16792, 10086, 60530, 172113, 44728, 10111, 42809, 140731, 159516, 90589, 11720,
          159408, 74565, 189623, 10742, 37488, 158180, 175366, 10029, 31524, 31307, 17255, 70562, 68934, 68498, 74632, 66091, 51787, 57278, 39524,
          64354, 26537, 39399, 109466, 127398, 63445, 129046, 39633, 17802, 45130, 173653, 76048, 96968, 10128,
          91031, 62390, 129406, 24157, 37739, 76455, 23525, 129072, 163787, 172425, 200052, 157178, 93236, 10330,
          140803, 44885, 17143, 97652, 33422, 151254, 142683, 36843, 83160, 27109, 10033, 113170, 126389, 162173,
          38907, 51049, 96327, 191917, 146214, 27350, 72393, 76020, 43678, 10055, 18318, 73018, 146488, 87571,
          190324, 93094, 19473, 187321, 177483, 62556, 16906, 120125, 113315, 94194, 162854, 10640, 149777, 139523, 183377, 82323, 107748, 33930,
          191545, 31271, 150117, 92038, 143416, 37838, 146944, 37409, 39405, 50785, 31579, 73075, 149504, 75401,
          45719, 19500, 160491, 29146, 31911, 36957, 70637, 99714, 76627, 35991, 10250, 41585, 38546, 16516, 36484,
          87309, 88495, 11354, 195450, 11092, 52548, 43609, 138576, 96054, 75606, 82239, 83268, 17773, 76560,
          11119, 38574, 31913, 189259, 183836, 192147, 70254, 18875, 139674, 149479, 43206, 149050, 61521, 17967, 65769, 194910, 179318, 127321,
          45944, 138601, 98276, 26544, 128212, 134898, 142691, 38662, 72081, 48074, 49007, 165722, 73477, 18814, 154449, 29044,
          147388, 179974, 83098, 36651, 10800, 10741, 17946, 185131, 61095, 203097, 28795, 197304, 31464, 39516, 17758, 32593,
          58538, 30685, 43153, 165025, 94775, 29378, 130983, 132991, 210808, 66440, 186613, 197487, 18597, 190728, 19456, 136890,
          35626, 132998, 39879, 18763, 31607, 35071, 115240, 77768, 96961, 18350, 66144, 52790, 28876, 17450, 150198, 208077,
          119632, 130957, 32588, 10100, 37245, 14397, 91696, 18216, 72363,
          72631, 158610, 31282, 143253, 118950, 99724, 10253, 186615, 134845, 80866, 146508, 143456, 50932, 159311, 36617,
          165751, 123433, 27260, 39157, 51624, 113348, 19541, 64961, 39846, 142241, 153279, 86197, 153951, 100639, 38420, 37853,
          74309, 159848, 18285, 159054, 136872, 119914, 73496, 170496, 116251, 179139, 16571, 60755, 33759, 47494, 36763, 93089,
          36732, 77154, 189624, 39043, 44910, 180374, 98280, 187324, 35070, 147896, 98432, 172040, 40032,
          80629, 48159, 34598, 37756, 59032, 149731, 78681, 53781, 37261, 19063, 96325, 172118, 34225, 92176, 19394, 154226, 36950,
          96997, 109920, 115296, 30786, 168298, 38106, 10106, 181554, 179307, 33420, 158628, 170874, 121052, 95541, 137010, 172768,
          61482, 11089, 112042, 25749, 155484, 53372, 185423, 38338, 39369, 31629, 144945, 97858, 148909, 39750, 37386, 10245, 132610,
          126078, 31705, 118348, 162932, 87246, 39708, 154298, 39676, 207364, 194321, 10962, 109626, 123095, 130376, 28792, 81106,
          84856, 61056, 87663, 152265, 72058, 64170,
          18003, 167049, 125459, 52794, 88226, 137956, 39150, 23849, 174805, 42867, 125438, 145292, 52757, 193800, 24602, 106540,
          10132, 60484, 32126, 19505, 73411, 34447, 31814, 164684, 16211, 109984, 71546, 75415, 78240, 74003, 25641, 17787, 52747,
          62789, 19479, 136873, 163798, 91703, 33513, 66728, 64126, 50583, 11722, 113635, 101904, 31904, 123420, 149236, 114276, 19059,
          18489, 92312, 39576, 62249, 10793, 167053, 132626, 37487, 137281, 44981, 135342,
          74315, 88474, 67374, 100938, 41350, 33682, 50869, 34514, 93774, 25676, 134887, 124225, 49302, 38898, 18153, 193328, 129094,
          88426, 31565, 151747, 10519, 51282, 202901, 107928, 19302, 161374, 38083, 39473, 40678, 86818, 17150, 63379, 17173, 70393,
          152183, 164719, 182360, 167613, 17062, 66795, 47638, 37758, 17458, 88783, 65677, 48310, 90388, 171533, 52425, 88253, 103545,
          142634, 114265, 75006, 192614, 189373, 51579, 43516, 54565, 69270, 69024, 41595, 98728, 102216, 45253, 69951, 61865, 12954,
          37742, 39841, 38378, 171465, 35175,
          41590, 43502, 31323, 162471, 17498, 101242, 35900, 100924, 65290, 50749, 79439, 61701, 11290, 141824, 184520, 51158, 38197,
          50218, 50176, 97692, 18046, 144330, 101248, 94506, 18487, 38908, 149012, 134963, 66143, 61273, 152632, 159645, 11810, 156477,
          37073, 123268, 118922, 11093, 167638, 66437, 62699, 101962, 31267, 10065, 118370, 92412, 63879, 51689, 163386, 128265,
          146548, 197520, 133447, 66598, 38551, 92064, 125447,
          44997, 154288, 111527, 54435, 27255, 52429, 72362, 31066, 31708, 90901, 99355, 169643, 13314, 31893, 125401, 34449, 85606,
          61101, 25578, 58434, 122596, 47359, 61450, 144355, 89606, 46153, 47407, 186348, 168017, 82283, 24831, 11671, 18015, 43370,
          141259, 56447, 83865, 91045, 57794, 94766, 65991, 73096, 118966, 43114, 134980, 10758, 109642, 36506, 17230, 41635, 44044,
          122581, 10149, 38455, 114248, 66317, 39619, 150632, 130984, 97857, 142730, 32478, 156091, 81891, 156675, 19501, 18429,
          87311, 68501, 47408, 154980, 17692, 129282,
          132946, 191560, 18563, 136842, 149505, 32240, 23848, 122602, 78851, 114293, 151744, 34519, 143379, 96911, 65893, 67366,
          131637, 70118, 34969, 136898, 123298, 126961, 103797, 149757, 112082, 29712, 68217, 158611, 99740, 17025, 81967, 48690,
          191914, 18933, 38547, 33048, 25670, 101950, 74610, 149512, 140895, 92047, 187526, 137971, 136686, 63483, 109957, 37686,
          137915, 167651, 82142, 118367, 49957, 37938, 92505, 72443, 104331, 33062, 99799, 62742,
          39479, 196362, 72406, 97816, 40208, 49380, 35733, 196215, 17058, 154293, 18730, 161967, 134134, 130943, 36853, 133424,
          66034, 76103, 53902, 74566, 72524, 164102, 120759, 179430, 68035, 62175, 153964, 62167, 70992, 110125, 44022, 30343,
          124238, 167658, 81028, 19078, 78790, 168779, 37355, 38318, 118395, 152396, 19334, 47587, 37049, 112666, 114139, 154029,
          189028, 121047, 76014, 10453, 85351, 19529, 136821, 95203, 22012, 167599, 39368, 143435, 184318, 165514, 50278, 46874,
          132627, 36337, 140695, 129383, 76580, 56362, 126386, 163832,
          10546, 196389, 28465, 124201, 39769, 46528, 137952, 25633, 122489, 93756, 146526, 144578, 44449, 88461, 49783, 10501,
          68945, 99094, 190320, 32026, 94503, 129333, 160750, 19076, 189118, 32900, 118384, 35388, 10107, 134136, 167605, 117786,
          66381, 49483, 11088, 168045, 144984, 53152, 18353, 100076, 38789, 180382, 140652, 129049, 152680, 29797, 173840,
          66102, 34190, 164101, 36742, 67195, 51786, 44006, 96910, 73074, 65923, 129164, 187787, 134133, 50721, 189053, 118323,
          52996, 129459, 185285, 135807, 27564, 69689, 10068, 74453, 152625, 136845, 51781, 101062, 178067, 148996, 145376,
          108734, 34431, 125423, 109971, 191143, 38384, 38364, 11757, 159892, 133496, 56065, 95808, 170859, 53350, 34501, 19503, 52245, 17116,
          16121, 38319, 106522, 142625, 100015, 137347, 88494, 89755, 19459, 129096, 68258, 175318, 144968, 97612, 52551,
          130344, 65113, 167637, 125405, 47425,
          38572, 66725, 55405, 10636, 91606, 83546, 53307, 94300, 86823, 181711, 54704, 32667, 125439, 12918, 134891, 79315, 14425, 34532, 114142, 110333, 137884, 60022, 93028, 39441, 171785, 150097, 37642, 140139, 60480, 141104,
          185912, 98483, 71486, 149747, 142803, 110649, 18347, 151153, 69099, 52498, 196809, 66820, 135874, 148863, 10073, 54349,
          26350, 23847, 42842, 175039, 94767, 122197, 158645, 182407, 63969, 124288, 49637, 172816, 134859, 144213, 101963, 137976,
          137908, 147945, 78845, 72222, 158626, 47428, 52972, 193804, 192150, 150688, 125466, 65751, 167105, 95873, 39910, 65553,
          146459, 10066, 22080, 40034, 60510, 113303, 51957, 172344, 155665, 149576, 76791, 66001, 118955, 78846, 113983, 37708, 159894,
          134685, 193781, 125841, 120157, 115955, 94183, 92067, 33652, 113163, 34416, 98438, 10095, 94170, 47370, 76439, 163844, 37733,
          130720, 144975, 85640, 45535, 127707, 162423, 174903, 25970, 31606, 194813, 76444, 139438, 128235, 116234, 103324, 92827,
          113344, 158621, 13244, 146480, 39427, 34076, 102431, 41334, 156083, 71083, 72043, 47404, 57897, 74893, 31371, 99794, 113301,
          121922, 31310, 52553, 43210, 133457, 154136, 51082, 32972, 63824, 162249, 140787, 156200, 169637, 39908, 105015, 16201,
          63562, 32723, 16570, 74058, 63515, 102817, 29223, 163831, 37720, 86177, 62560, 187629, 66834, 127361, 174832, 133223,
          66253, 142384, 137972, 107306, 153652, 69866, 53041, 105002, 136893, 212095, 63113, 189141, 210282, 136869, 158266, 118953,
          159806, 42931, 165669, 116327, 125468, 43610, 68204, 143390, 134847, 49336, 32975, 84414, 85633, 106332, 127866, 38823, 73301,
          63485, 157500, 90885, 164172, 125419, 28910, 70615, 78672, 82262, 91603, 47364, 82227, 125426, 58273, 12787, 79770, 118347, 22749,
          41592, 85141, 123275, 51386, 66464, 82389, 17920, 190991, 42869, 108043, 39632, 69023, 54871, 25917, 54290, 69339, 151192, 36352,
          38138, 65242, 100990, 92003, 175322, 81464, 36720, 66751, 29892, 64161, 43679, 69467, 91189, 35110, 47401, 91391, 48227, 67901,
          42690, 80219, 98744, 61103, 61845, 179398, 102309, 132933, 148647, 64089, 93002, 175045, 118652, 37951, 149797, 35941, 124844,
          164108, 18564, 127378, 75426, 129671, 17790, 31939, 38582, 38906, 125414, 76692, 90922, 27404, 28099, 34486, 76956, 97693, 66520,
          17417, 93793, 160399, 17416, 87163, 127767, 39723, 80626, 10024, 51132, 114225, 82924, 115642, 75173, 87305, 119430, 159741,
          106335, 68063, 63017, 76452, 118954, 65473, 17462, 47701, 65877, 109640, 90591, 36839, 81834, 33837, 66069]
extra_code_num = []
index = 0
for i in code_num:
    urls = f'https://movie.naver.com/movie/bi/mi/basic.naver?code={i}'
    for j in range(1, 6):
        html = requests.get(urls)
        soup = BeautifulSoup(html.content, 'html.parser')

        title_url = soup.select_one(
            f' #content > div.article > div:nth-child(7) > div:nth-child({j})  ')
        if title_url == None:
            continue
        else:
            extra_code_num.append(title_url)
            #print("appending similar movie")
        index +=1
        print("done", i, " | ", index)

extra_code_num = set(extra_code_num)
print(extra_code_num)
print(len(extra_code_num))

#for i in range(0, len(extra_code_num)):
#    print("chaging similar")
#
#    a = list(str(extra_code_num[i]))
#
#    for j in range(0, len(a) - 3):

#        if a[j] == "c" and a[j + 1] == "o" and a[j + 2] == "d" and a[j + 3] == "e":
#            if a[j + 11] == " " or a[j + 11] == "#" or a[j + 11] == "&":
#                code_num.append(int("".join(a[j + 5:j + 10])))
#                break
#            elif a[j + 9] == " " or a[j + 9] == "#" or a[j + 9] == "&":
#                code_num.append(int("".join(a[j + 5:j + 8])))
#                break
#            elif a[j + 10] == " " or a[j + 10] == "#" or a[j + 10] == "&":
#                code_num.append(int("".join(a[j + 5:j + 9])))
#                break
#            else:
#                code_num.append(int("".join(a[j + 5:j + 11])))
#                break





